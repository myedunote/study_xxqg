import{d as q,K as A,bE as z,c as F,w,u as U,a6 as H,o as d,a2 as e,aa as f,a5 as p,aW as B,am as r,a9 as I,bc as N,bd as M,be as P,bf as W,W as j,bF as G,bG as K,bh as Q,bi as R,T as J,bj as O,bk as X,bl as Z,bH as E,a as S,br as ee,bs as se,bI as te,bq as oe,bo as ae}from"./home-8ca0f577.js";import{E as ne,b as ce,d as L}from"./el-progress-cdc3b520.js";const Y=c=>(N("data-v-3136009b"),c=c(),M(),c),le={class:"total flex"},ie={class:"flex flex-1 justify-center flex-col items-center"},re=Y(()=>e("span",null,"总分",-1)),de={class:"flex flex-1 justify-center flex-col items-center"},ue=Y(()=>e("span",null,"今日",-1)),_e={style:{width:"8em"}},pe=q({__name:"index",props:{score:{default:""},modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(c,{emit:l}){const m=c,V=["#6a994e","#2a9d8f","#e9c46a","#f4a261","#e76f51","#118ab2","#85586F"],h=A({get(){return m.modelValue},set(v){l("update:modelValue",v)}});function x(v){const u=v.split(/[\n]/).map(_=>{const y=_.split("：");return{name:y[0],score:y[1]}}),[g,k,...i]=u,b=i.map(_=>{_.name==="专项答题"&&(_.score=_.score.split("/")[0]+"/5");const y=_.score.split("/");return{..._,percentage:100/Number(y[1])*Number(y[0])}});return{score:g.score,daily:k.score,dailyList:b}}return(v,u)=>{const g=ne,k=z;return d(),F(k,{class:"score-popup flex flex-col justify-around",show:U(h),"onUpdate:show":u[0]||(u[0]=i=>H(h)?h.value=i:null),position:"bottom",style:{height:"60%"}},{default:w(()=>[e("div",le,[e("div",ie,[re,e("h1",null,f(x(c.score).score),1)]),e("div",de,[ue,e("h1",null,f(x(c.score).daily),1)])]),(d(!0),p(I,null,B(x(c.score).dailyList,(i,b)=>(d(),p("div",{class:"detail flex",key:b},[e("div",_e,f(`${i.name} (${i.score})`),1),r(g,{class:"flex-auto","text-inside":!0,"stroke-width":18,color:V[b],percentage:i.percentage!==null?Math.ceil(i.percentage):100},null,8,["color","percentage"])]))),128))]),_:1},8,["show"])}}});const fe=P(pe,[["__scopeId","data-v-3136009b"]]),D=c=>(N("data-v-7e3cc3a0"),c=c(),M(),c),me={class:"mobile-user-list-container"},ve={class:"nav flex justify-between items-center"},ye={class:"box"},he={class:"box-item"},xe=D(()=>e("div",null,"UID",-1)),be={class:"box-item"},we=D(()=>e("div",null,"添加时间",-1)),ge={class:"box-item"},ke=D(()=>e("div",null,"挂机时长",-1)),Se={class:"footer flex justify-between"},Ce={key:0},$e={key:1},Ue={class:"flex justify-between flex-col items-center"},Ie={class:"flex justify-end",style:{width:"100%"}},De={class:"qrcode flex flex-col justify-between items-center flex-auto"},Ve={class:"flex-auto flex items-center"},je={class:"wait"},Le=D(()=>e("span",{class:"dotting"},null,-1)),Te={key:1},Ee={class:"link",style:{width:"100%"}},qe=q({__name:"index",setup(c){const l=W({search:"",tableData:[],currUserScore:"",showScore:!1}),m=j(!1),V=j(!0),h=j(null);let x=null,v="";const u=async()=>{const{data:o,success:t}=await Q(),a=o.map(n=>(n.status=!0,n));t&&(l.tableData=a),await g()},g=async()=>{const{data:o,success:t}=await R();if(!t||t&&!o)return;const a=o.map(n=>(n.status=!1,n.login_time=n.loginTime,n));l.tableData=l.tableData.concat(a)};u();async function k(o,t){const{success:a}=t?await ee(o):await se(o);a&&await u()}function i(o,t){te({title:"提示",message:`是否删除${t}?`}).then(async()=>{const{success:a}=await oe(o);!a||(E({type:"success",message:"Delete completed"}),u())}).catch()}const b=async o=>{const{data:t,success:a}=await ae(o);l.currUserScore=a?t:"",l.showScore=!0},_=async()=>{m.value=!0,await J();const o=h.value,{url:t,code:a,sign:n}=await O();v=t,ce.toCanvas(o,t||"Test",{margin:0,scale:4});const C=setInterval(async()=>{const{data:s,success:$}=await X(a);$&&(clearInterval(C),(await Z(s.split("=")[1],n)).success&&(E({type:"success",message:"用户添加成功！"}),await u(),m.value=!1))},5e3);x=C},y=()=>{clearInterval(x)};function T(){const o=document.createElement("a");o.href="dtxuexi://appclient/page/study_feeds?url="+escape(v),o.click()}return(o,t)=>{const a=G,n=K,C=z;return d(),p(I,null,[e("div",me,[(d(!0),p(I,null,B(l.tableData,s=>(d(),p("div",{class:"user-card",key:s.uid},[e("div",ve,[e("div",null,f(s.nick),1),e("div",null,[r(a,{name:s.status?"smile-o":"warning-o",color:s.status?"green":"red",size:"20"},null,8,["name","color"])])]),e("div",ye,[e("div",he,[xe,e("span",null,f(s.uid),1)]),e("div",be,[we,e("span",null,f(U(L).unix(s.login_time).format("YYYY年MM月DD日 HH:mm:ss")),1)]),e("div",ge,[ke,e("span",null,f(U(L)().diff(U(L).unix(s.login_time),"day")+"天"),1)])]),e("div",Se,[s.status?(d(),p("div",Ce,[r(n,{type:s.is_study?"warning":"success",size:"mini",onClick:$=>k(s.uid,s.is_study)},{default:w(()=>[S(f(s.is_study?"停止学习":"开始学习"),1)]),_:2},1032,["type","onClick"]),r(n,{type:"primary",size:"mini",onClick:$=>b(s.token)},{default:w(()=>[S(" 分数查询 ")]),_:2},1032,["onClick"])])):(d(),p("div",$e)),r(n,{type:"danger",size:"mini",onClick:$=>i(s.uid,s.nick)},{default:w(()=>[S(" 删除 ")]),_:2},1032,["onClick"])])]))),128))]),r(fe,{score:l.currUserScore,modelValue:l.showScore,"onUpdate:modelValue":t[0]||(t[0]=s=>l.showScore=s)},null,8,["score","modelValue"]),e("div",{class:"add-user",onClick:_},[r(a,{name:"plus",size:"25"})]),r(C,{class:"qrcode",show:m.value,"onUpdate:show":t[2]||(t[2]=s=>m.value=s),onClose:y},{default:w(()=>[e("div",Ue,[e("nav",Ie,[r(a,{name:"cross",size:"20",onClick:t[1]||(t[1]=s=>m.value=!1)})]),e("div",De,[e("div",Ve,[e("canvas",{ref_key:"qrcode",ref:h},null,512)]),e("div",je,[V.value?(d(),p(I,{key:0},[S(" 等待扫码中"),Le],64)):(d(),p("span",Te," 扫码完成 "))])]),e("div",Ee,[r(n,{block:"",type:"primary",onClick:T},{default:w(()=>[S(" 调用APP跳转登录 ")]),_:1})])])]),_:1},8,["show"])],64)}}});const Me=P(qe,[["__scopeId","data-v-7e3cc3a0"]]);export{Me as default};
